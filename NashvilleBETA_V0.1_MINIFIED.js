const storeId=73175160,token="public_BTNfDsq3gAQa6rztRGyuGm6cu8yJqGmq",ptoken="secret_N8VmHUJgBESRMA2ihnJUawPVkLRjdgM1",barCodePrefix="ORDER-";var orderId,qTickets,fStatus,orderNumber,aNotes,barCode;function onScanSuccess(e,t){barCode=t,String(barCode.decodedText.slice(0,6))==barCodePrefix?(console.log(barCode.decodedText+" Is Proper Barcode"),$("#qrCode").text(barCode.decodedText.slice(6)),$("#orderNum").val(barCode.decodedText.slice(6)),searchOrders(),setTimeout(function(){console.log("Scanning Again")},2e3)):console.log("Error Reading BarCode")}var html5QrcodeScanner=new Html5QrcodeScanner("qr-reader",{fps:10,qrbox:300});function searchOrders(){orderNumber=$("#orderNum").val();var e={async:!0,crossDomain:!0,url:"https://app.ecwid.com/api/v3/"+storeId+"/orders?ids="+(orderId=orderNumber)+"&token="+ptoken,method:"GET",headers:{Accept:"application/json"}};$.ajax(e).done(function(e){if(0==e.count)console.log("NO ITEMS FOUND"),$("#showName").text("Please Re-Run Bar Code Scan"),$("#firstName").text("Cleared Value"),$("#lastName").text("Cleared Value"),$("#email").text("Cleared Value"),$("#fStatus").text("Cleared Value"),$("#qrCode").text("Cleared Value"),$("#notes").text("Cleared Value"),$("#tickets").text("#"),$("#quant").empty();else if(e.count>0){console.log(e),$("#firstName").text(e.items[0].shippingPerson.firstName),$("#lastName").text(e.items[0].shippingPerson.lastName),$("#email").text(e.items[0].email),$("#notes").text(e.items[0].privateAdminNotes),$("#tickets").text(e.items[0].items[0].quantity),$("#showName").text(e.items[0].items[0].name),$("#qrCode").text(orderId),qTickets=e.items[0].items[0].quantity,fStatus=e.items[0].fulfillmentStatus;var t=e.items[0].fulfillmentStatus;"AWAITING_PROCESSING"==t?$("#fStatus").text("Some or none of the tickets have been admitted."):"DELIVERED"==t?$("#fStatus").text("ALL of the tickets have been admitted."):$("#fStatus").text(e.items[0].fulfillmentStatus),$("#quant").empty();for(let t=0;t<e.items[0].items[0].quantity;t++)optionValue=t+1,$("#quant").append(`<option value="${optionValue}">${optionValue}</option>`)}else console.log("Did not run search")})}function editOrders(){var e=$("#quant option:selected").text().toString(),t=String(e+" out of "+qTickets+" Tickets Admitted"),o={async:!0,crossDomain:!0,url:"https://app.ecwid.com/api/v3/"+storeId+"/orders/"+orderId+"?token="+ptoken,method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},processData:!0,data:"{privateAdminNotes: "+t+", fulfillmentStatus: "+(fStatus=e==qTickets?"DELIVERED":"AWAITING_PROCESSING")+"}"};$.ajax(o).done(function(e){console.log(t),console.log(e),searchOrders()})}html5QrcodeScanner.render(onScanSuccess),$("#firstName").text(""),$("#lastName").text(""),$("#email").text(""),$("#fStatus").text(""),$("#search").click(function(){searchOrders()}),$("#edit").click(function(){editOrders()});
