const storeId=73177391,token="public_7MZMV4tVMpeXXjsgKZbnSsmNQ6PQ9vkH",ptoken="secret_bQZqubGJryLCVhPgf6yEEjvnasrQqz7u";var orderId,qTickets,fStatus,tktArray,barCode,qChecker;function onScanSuccess(e,t){barCode=t,$("#qrCode").text(barCode.decodedText),$("#orderNum").val(barCode.decodedText),$(".ecwid-search-btn").css("background","#4f8d18")}$("#orderNum").focus();var html5QrcodeScanner=new Html5QrcodeScanner("qr-reader",{fps:10,qrbox:{width:220,height:220},rememberLastUsedCamera:!0,supportedScanTypes:[Html5QrcodeScanType.SCAN_TYPE_CAMERA]});function searchOrders(){if($("#orderNum").val().length>5){var e=$("#orderNum").val();$("#orderNum").val(e.slice(-5))}$(".ecwid-search-btn").css("background","#8d1d18"),orderId=$("#orderNum").val().toUpperCase();var t={async:!0,crossDomain:!0,url:"https://app.ecwid.com/api/v3/"+storeId+"/orders?ids="+orderId+"&token="+ptoken,method:"GET",headers:{Accept:"application/json"}};$.ajax(t).done(function(e){if(0==e.count)console.log("NO ITEMS FOUND"),$("#firstName").text("Run"),$("#lastName").text("Search"),$("#email").text("Pending..."),$("#fStatus").text("Pending Search"),$("#qrCode").text("#####"),$("#tickets").text("#"),$("#list-container").empty();else if(e.count>0){$("#firstName").text(e.items[0].shippingPerson.firstName),$("#lastName").text(e.items[0].shippingPerson.lastName),$("#email").text(e.items[0].email);var t=e.items[0].privateAdminNotes;$("#tickets").text(e.items[0].items.length),$("#qrCode").text(orderId),qTickets=e.items[0].items.length,fStatus=e.items[0].fulfillmentStatus;var s="";if(void 0===t){for(n=0;n<e.items[0].items.length;n++)s+="0&";s=s.split("&")}else if("&"===t.slice(-1))s=t.split("&");else{for(n=0;n<e.items[0].items.length;n++)s+="0&";s=s.split("&")}var i=e.items[0].fulfillmentStatus;"AWAITING_PROCESSING"==i?$("#fStatus").text("Some or none of the tickets have been admitted."):"DELIVERED"==i?$("#fStatus").text("ALL of the tickets have been admitted."):$("#fStatus").text(e.items[0].fulfillmentStatus);var a="",r="";for(let t=0;t<e.items[0].items.length;t++){var o=s[t],d=e.items[0].items[t].name,c=e.items[0].items[t].quantity;a+=c+"&";var l="",m="";o==c&&(m+=" finished");for(let e=0;e<=c;e++)l+=`\n                                                    <option value="${e}">${e}</option> \n                                    `;r+=`\n                                <div class="list-item${m}">\n                                    <div class="list-item-title">${d}</div>\n                                    <div class="list-item-status">${o} of ${c} tickets admitted</div>\n                                    <div class="list-admissions-change-div">\n                                    <div class="list-admissions-text">Admitted</div>\n                                    <div class="admissions-select w-embed">\n                                        <select name="currentQuant" id="quant-${t}" style="padding-left: 10px; padding-right: 10px; width: 50px; height: 36px;">\n                                            ${l}\n                                        </select>\n                                    </div>\n                                    <div class="list-admissions-text">Out Of</div><div class="list-total-admissions">${c}</div><div class="list-admissions-text">Tickets</div></div>\n                                </div>    \n                                `}for(qChecker=a,document.querySelector(".list-container").innerHTML=r,q=0;q<e.items[0].items.length;q++){var u="#quant-"+q,f=s[q].toString();$(u).val(f).change()}}else console.log("Did not run search")}),$("#orderNum").focus()}function editOrders(){var e="";for(let t=0;t<qTickets;t++){e+=($("#quant-"+t+" option:selected").text().toString()+"&").toString()}var t={async:!0,crossDomain:!0,url:"https://app.ecwid.com/api/v3/"+storeId+"/orders/"+orderId+"?token="+ptoken,method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},processData:!0,data:"{privateAdminNotes: "+e+", fulfillmentStatus: "+(fStatus=qChecker===e?"DELIVERED":"AWAITING_PROCESSING")+"}"};$.ajax(t).done(function(e){console.log(e),searchOrders()}),$("#orderNum").focus()}html5QrcodeScanner.render(onScanSuccess),$("#firstName").text("Run"),$("#lastName").text("Search"),$("#email").text("Pending..."),$("#fStatus").text("Pending Search"),$("#qrCode").text("#####"),$("#tickets").text("#"),$("#list-container").empty(),$("#search").click(function(){searchOrders()}),$("#orderNum").keyup(function(e){13===e.keyCode&&$("#search").click()}),sampleJson='[{color: "red",value: "#f00"},{color: "magenta",value: "#f0f"},{color: "yellow",value: "#ff0"},{color: "black",value: "#000"}]',$("#edit").click(function(){editOrders()});
